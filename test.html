<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãŠã¿ãã˜ã‚¢ãƒ—ãƒª ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .pass { background-color: #d4edda; color: #155724; }
        .fail { background-color: #f8d7da; color: #721c24; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ãŠã¿ãã˜ã‚¢ãƒ—ãƒª ãƒ†ã‚¹ãƒˆ</h1>
        <div id="testResults"></div>
        <button onclick="runTests()">ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</button>
        <button onclick="runMultipleDraws()">è¤‡æ•°å›ãƒ†ã‚¹ãƒˆ (10å›)</button>
    </div>

    <script>
        // ãŠã¿ãã˜ã®çµæœãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã¨åŒã˜ï¼‰
        const fortunes = [
            {
                level: "å¤§å‰",
                class: "daikichi",
                messages: [
                    "ç´ æ™´ã‚‰ã—ã„ä¸€æ—¥ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚",
                    "å¹¸é‹ãŒã‚ãªãŸã‚’å¾…ã£ã¦ã„ã¾ã™ã€‚ç©æ¥µçš„ã«è¡Œå‹•ã—ã¾ã—ã‚‡ã†ã€‚",
                    "ä»Šæ—¥ã¯ç‰¹åˆ¥ãªæ—¥ã§ã™ã€‚å¤§åˆ‡ãªäººã¨ã®æ™‚é–“ã‚’å¤§åˆ‡ã«ã—ã¦ãã ã•ã„ã€‚"
                ]
            },
            {
                level: "å‰",
                class: "kichi",
                messages: [
                    "è‰¯ã„ã“ã¨ãŒèµ·ã“ã‚Šãã†ã§ã™ã€‚ç¬‘é¡”ã‚’å¿˜ã‚Œãšã«éã”ã—ã¾ã—ã‚‡ã†ã€‚",
                    "ç©ã‚„ã‹ãªä¸€æ—¥ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚å‘¨ã‚Šã®äººã«æ„Ÿè¬ã®æ°—æŒã¡ã‚’ä¼ãˆã¦ãã ã•ã„ã€‚",
                    "å°ã•ãªå¹¸ã›ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹æ—¥ã§ã™ã€‚èº«ã®å›ã‚Šã«æ³¨æ„ã‚’å‘ã‘ã¦ã¿ã¦ãã ã•ã„ã€‚"
                ]
            },
            {
                level: "ä¸­å‰",
                class: "chukichi",
                messages: [
                    "ã¾ãšã¾ãšã®é‹å‹¢ã§ã™ã€‚ç„¦ã‚‰ãšã‚†ã£ãã‚Šã¨é€²ã¿ã¾ã—ã‚‡ã†ã€‚",
                    "å®‰å®šã—ãŸä¸€æ—¥ã«ãªã‚Šãã†ã§ã™ã€‚è¨ˆç”»ã‚’ç«‹ã¦ã¦è¡Œå‹•ã—ã¦ãã ã•ã„ã€‚",
                    "åŠªåŠ›ãŒå®Ÿã‚’çµã¶æ™‚æœŸã§ã™ã€‚ç¶™ç¶šã™ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚"
                ]
            },
            {
                level: "å°å‰",
                class: "shokichi",
                messages: [
                    "å°ã•ãªå¹¸ã›ãŒè¦‹ã¤ã‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å‘¨ã‚Šã‚’ã‚ˆãè¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚",
                    "æ…é‡ã«è¡Œå‹•ã™ã‚Œã°è‰¯ã„çµæœãŒå¾—ã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚",
                    "ä»Šæ—¥ã¯å­¦ã³ã®æ—¥ã§ã™ã€‚æ–°ã—ã„çŸ¥è­˜ã‚’èº«ã«ã¤ã‘ã¦ã¿ã¦ãã ã•ã„ã€‚"
                ]
            },
            {
                level: "å‡¶",
                class: "kyo",
                messages: [
                    "ä»Šæ—¥ã¯æ…é‡ã«è¡Œå‹•ã—ã¾ã—ã‚‡ã†ã€‚æ˜æ—¥ã¯ãã£ã¨è‰¯ã„æ—¥ã«ãªã‚Šã¾ã™ã€‚",
                    "å›°é›£ãŒã‚ã£ã¦ã‚‚è«¦ã‚ãªã„ã§ãã ã•ã„ã€‚å¿…ãšé“ã¯é–‹ã‘ã¾ã™ã€‚",
                    "ä»Šã¯æº–å‚™ã®æ™‚æœŸã§ã™ã€‚æ¬¡ã®ãƒãƒ£ãƒ³ã‚¹ã«å‚™ãˆã¾ã—ã‚‡ã†ã€‚"
                ]
            }
        ];

        function drawFortune() {
            const randomIndex = Math.floor(Math.random() * fortunes.length);
            const selectedFortune = fortunes[randomIndex];
            const messageIndex = Math.floor(Math.random() * selectedFortune.messages.length);
            const selectedMessage = selectedFortune.messages[messageIndex];

            return {
                level: selectedFortune.level,
                class: selectedFortune.class,
                message: selectedMessage
            };
        }

        function runTests() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<h2>ãƒ†ã‚¹ãƒˆçµæœ</h2>';

            let passCount = 0;
            let totalTests = 0;

            // ãƒ†ã‚¹ãƒˆ1: ãŠã¿ãã˜ãŒæ­£å¸¸ã«å¼•ã‘ã‚‹ã‹
            totalTests++;
            try {
                const result = drawFortune();
                if (result && result.level && result.class && result.message) {
                    results.innerHTML += '<div class="test-result pass">âœ“ ãƒ†ã‚¹ãƒˆ1: ãŠã¿ãã˜ãŒæ­£å¸¸ã«å¼•ã‘ã¾ã—ãŸ</div>';
                    passCount++;
                } else {
                    results.innerHTML += '<div class="test-result fail">âœ— ãƒ†ã‚¹ãƒˆ1: ãŠã¿ãã˜ã®çµæœãŒä¸å®Œå…¨ã§ã™</div>';
                }
            } catch (error) {
                results.innerHTML += '<div class="test-result fail">âœ— ãƒ†ã‚¹ãƒˆ1: ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ - ' + error.message + '</div>';
            }

            // ãƒ†ã‚¹ãƒˆ2: å…¨ã¦ã®é‹å‹¢ãƒ¬ãƒ™ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹
            totalTests++;
            const expectedLevels = ["å¤§å‰", "å‰", "ä¸­å‰", "å°å‰", "å‡¶"];
            const actualLevels = fortunes.map(f => f.level);
            const hasAllLevels = expectedLevels.every(level => actualLevels.includes(level));

            if (hasAllLevels) {
                results.innerHTML += '<div class="test-result pass">âœ“ ãƒ†ã‚¹ãƒˆ2: å…¨ã¦ã®é‹å‹¢ãƒ¬ãƒ™ãƒ«ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™</div>';
                passCount++;
            } else {
                results.innerHTML += '<div class="test-result fail">âœ— ãƒ†ã‚¹ãƒˆ2: é‹å‹¢ãƒ¬ãƒ™ãƒ«ãŒä¸è¶³ã—ã¦ã„ã¾ã™</div>';
            }

            // ãƒ†ã‚¹ãƒˆ3: å„é‹å‹¢ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå­˜åœ¨ã™ã‚‹ã‹
            totalTests++;
            const hasMessages = fortunes.every(fortune =>
                fortune.messages && fortune.messages.length > 0
            );

            if (hasMessages) {
                results.innerHTML += '<div class="test-result pass">âœ“ ãƒ†ã‚¹ãƒˆ3: å…¨ã¦ã®é‹å‹¢ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™</div>';
                passCount++;
            } else {
                results.innerHTML += '<div class="test-result fail">âœ— ãƒ†ã‚¹ãƒˆ3: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒä¸è¶³ã—ã¦ã„ã‚‹é‹å‹¢ãŒã‚ã‚Šã¾ã™</div>';
            }

            // ãƒ†ã‚¹ãƒˆ4: ãƒ©ãƒ³ãƒ€ãƒ æ€§ã®ãƒ†ã‚¹ãƒˆï¼ˆ100å›å®Ÿè¡Œã—ã¦å…¨ã¦åŒã˜çµæœã§ãªã„ã‹ï¼‰
            totalTests++;
            const results100 = [];
            for (let i = 0; i < 100; i++) {
                results100.push(drawFortune().level);
            }
            const uniqueResults = [...new Set(results100)];

            if (uniqueResults.length > 1) {
                results.innerHTML += '<div class="test-result pass">âœ“ ãƒ†ã‚¹ãƒˆ4: ãƒ©ãƒ³ãƒ€ãƒ æ€§ãŒç¢ºèªã•ã‚Œã¾ã—ãŸ (' + uniqueResults.length + 'ç¨®é¡ã®çµæœ)</div>';
                passCount++;
            } else {
                results.innerHTML += '<div class="test-result fail">âœ— ãƒ†ã‚¹ãƒˆ4: ãƒ©ãƒ³ãƒ€ãƒ æ€§ã«å•é¡ŒãŒã‚ã‚Šã¾ã™</div>';
            }

            // çµæœã‚µãƒãƒªãƒ¼
            results.innerHTML += `<h3>ãƒ†ã‚¹ãƒˆçµæœ: ${passCount}/${totalTests} åˆæ ¼</h3>`;
            if (passCount === totalTests) {
                results.innerHTML += '<div class="test-result pass">ğŸ‰ å…¨ã¦ã®ãƒ†ã‚¹ãƒˆã«åˆæ ¼ã—ã¾ã—ãŸï¼</div>';
            }
        }

        function runMultipleDraws() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<h2>è¤‡æ•°å›ãƒ†ã‚¹ãƒˆçµæœ</h2>';

            const drawResults = {};
            for (let i = 0; i < 10; i++) {
                const result = drawFortune();
                if (!drawResults[result.level]) {
                    drawResults[result.level] = 0;
                }
                drawResults[result.level]++;

                results.innerHTML += `<div class="test-result pass">
                    ${i + 1}å›ç›®: <strong>${result.level}</strong> - ${result.message}
                </div>`;
            }

            results.innerHTML += '<h3>çµæœçµ±è¨ˆ</h3>';
            for (const [level, count] of Object.entries(drawResults)) {
                results.innerHTML += `<div>${level}: ${count}å›</div>`;
            }
        }
    </script>
</body>
</html>
